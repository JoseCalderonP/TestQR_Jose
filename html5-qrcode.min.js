/** Html5QrcodeScanner **/
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var Html5QrcodeScanner=function(){function a(b,c,d){if(_classCallCheck(this,a),this.elementId=b,this.config=c,this.verbose=!0===d,!document.getElementById(b))throw"HTML Element with id=".concat(b," not found");this.currentScanType=a.SCAN_TYPE_CAMERA,this.sectionSwapAllowed=!0,this.section=void 0,this.html5Qrcode=void 0,this.qrCodeSuccessCallback=void 0,this.qrCodeErrorCallback=void 0}return _createClass(a,[{key:"render",value:function(b,c){var d=this;this.lastMatchFound=void 0,this.qrCodeSuccessCallback=function(c){if(d.__setStatus("MATCH",a.STATUS_SUCCESS),b)b(c);else{if(d.lastMatchFound==c)return;d.lastMatchFound=c,d.__setHeaderMessage("Last Match: ".concat(c),a.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(a){d.__setStatus("Scanning"),c&&c(a)};var e=document.getElementById(this.elementId);e.innerHTML="",this.__createBasicLayout(e),this.html5Qrcode=new Html5Qrcode(this.__getScanRegionId(),this.verbose)}},{key:"clear",value:function(){var a=this,b=this,c=function(){var b=document.getElementById(a.elementId);b&&(b.innerHTML="",a.__resetBasicLayout(b))};if(this.html5Qrcode)return new Promise(function(a,d){b.html5Qrcode._isScanning&&b.html5Qrcode.stop().then(function(){b.html5Qrcode.clear(),c(),a()})["catch"](function(a){b.verbose&&console.error("Unable to stop qrcode scanner",a),d(a)})})}},{key:"__createBasicLayout",value:function(a){a.style.position="relative",a.style.padding="0px",a.style.border="1px solid silver",this.__createHeader(a);var b=document.createElement("div"),c=this.__getScanRegionId();b.id=c,b.style.width="100%",b.style.minHeight="100px",b.style.textAlign="center",a.appendChild(b),this.__insertCameraScanImageToScanRegion();var d=document.createElement("div"),e=this.__getDashboardId();d.id=e,d.style.width="100%",a.appendChild(d),this.__setupInitialDashboard(d)}},{key:"__resetBasicLayout",value:function(a){a.style.border="none"}},{key:"__setupInitialDashboard",value:function(a){this.__createSection(a),this.__createSectionControlPanel(),this.__createSectionSwap()}},{key:"__createHeader",value:function(a){var b=document.createElement("div");b.style.textAlign="left",b.style.margin="0px",b.style.padding="5px",b.style.fontSize="20px",b.style.borderBottom="1px solid rgba(192, 192, 192, 0.18)",a.appendChild(b);var c=document.createElement("span"),d=document.createElement("a");d.innerHTML="Code Scanner",d.href="https://github.com/mebjas/html5-qrcode",c.appendChild(d),b.appendChild(c);var e=document.createElement("span");e.id=this.__getStatusSpanId(),e.style.float="right",e.style.padding="5px 7px",e.style.fontSize="14px",e.style.background="#dedede6b",e.style.border="1px solid #00000000",e.style.color="rgb(17, 17, 17)",b.appendChild(e),this.__setStatus("IDLE");var f=document.createElement("div");f.id=this.__getHeaderMessageContainerId(),f.style.display="none",f.style.fontSize="14px",f.style.padding="2px 10px",f.style.marginTop="4px",f.style.borderTop="1px solid #f6f6f6",b.appendChild(f)}},{key:"__createSection",value:function(a){var b=document.createElement("div");b.id=this.__getDashboardSectionId(),b.style.width="100%",b.style.padding="10px",b.style.textAlign="left",a.appendChild(b)}},{key:"__createSectionControlPanel",value:function(){var b=this,c=document.getElementById(this.__getDashboardSectionId()),d=document.createElement("div");c.appendChild(d);var e=document.createElement("div");e.id=this.__getDashboardSectionCameraScanRegionId(),e.style.display=this.currentScanType==a.SCAN_TYPE_CAMERA?"block":"none",d.appendChild(e);var f=document.createElement("div");f.style.textAlign="center";var g=document.createElement("button");g.innerHTML="Request Camera Permissions",g.addEventListener("click",function(){g.disabled=!0,b.__setStatus("PERMISSION"),b.__setHeaderMessage("Requesting camera permissions..."),Html5Qrcode.getCameras().then(function(c){b.__setStatus("IDLE"),b.__resetHeaderMessage(),c&&0!=c.length?(e.removeChild(f),b.__renderCameraSelection(c)):b.__setStatus("No Cameras",a.STATUS_WARNING)})["catch"](function(c){g.disabled=!1,b.__setStatus("IDLE"),b.__setHeaderMessage(c,a.STATUS_WARNING)})}),f.appendChild(g),e.appendChild(f);var h=document.createElement("div");h.id=this.__getDashboardSectionFileScanRegionId(),h.style.textAlign="center",h.style.display=this.currentScanType==a.SCAN_TYPE_CAMERA?"none":"block",d.appendChild(h);var i=document.createElement("input");i.id=this.__getFileScanInputId(),i.accept="image/*",i.type="file",i.style.width="200px",i.disabled=this.currentScanType==a.SCAN_TYPE_CAMERA;var j=document.createElement("span");j.innerHTML="&nbsp; Select Image",h.appendChild(i),h.appendChild(j),i.addEventListener("change",function(c){if(b.currentScanType===a.SCAN_TYPE_FILE&&0!=c.target.files.length){var d=c.target.files[0];b.html5Qrcode.scanFile(d,!0).then(function(a){b.__resetHeaderMessage(),b.qrCodeSuccessCallback(a)})["catch"](function(c){b.__setStatus("ERROR",a.STATUS_WARNING),b.__setHeaderMessage(c,a.STATUS_WARNING),b.qrCodeErrorCallback(c)})}})}},{key:"__renderCameraSelection",value:function(b){var c=this,d=document.getElementById(this.__getDashboardSectionCameraScanRegionId());d.style.textAlign="center";var e=document.createElement("span");e.innerHTML="Select Camera (".concat(b.length,") &nbsp;"),e.style.marginRight="10px";var f=document.createElement("select");f.id=this.__getCameraSelectionId();for(var g=0;g<b.length;g++){var h=b[g],j=h.id,k=null==h.label?j:h.label,l=document.createElement("option");l.value=j,l.innerHTML=k,f.appendChild(l)}e.appendChild(f),d.appendChild(e);var m=document.createElement("span"),n=document.createElement("button");n.innerHTML="Start Scanning",m.appendChild(n);var o=document.createElement("button");o.innerHTML="Stop Scanning",o.style.display="none",o.disabled=!0,m.appendChild(o),d.appendChild(m),n.addEventListener("click",function(){f.disabled=!0,n.disabled=!0,c._showHideScanTypeSwapLink(!1);var b=c.config?c.config:{fps:10,qrbox:250},d=f.value;c.html5Qrcode.start(d,b,c.qrCodeSuccessCallback,c.qrCodeErrorCallback).then(function(){o.disabled=!1,o.style.display="inline-block",n.style.display="none",c.__setStatus("Scanning")})["catch"](function(b){c._showHideScanTypeSwapLink(!0),f.disabled=!1,n.disabled=!1,c.__setStatus("IDLE"),c.__setHeaderMessage(b,a.STATUS_WARNING)})}),o.addEventListener("click",function(){o.disabled=!0,c.html5Qrcode.stop().then(function(){c._showHideScanTypeSwapLink(!0),f.disabled=!1,n.disabled=!1,o.style.display="none",n.style.display="inline-block",c.__setStatus("IDLE"),c.__insertCameraScanImageToScanRegion()})["catch"](function(b){o.disabled=!1,c.__setStatus("ERROR",a.STATUS_WARNING),c.__setHeaderMessage(b,a.STATUS_WARNING)})})}},{key:"__createSectionSwap",value:function(){var b=this,c="Scan an Image File",d="Scan using camera directly",e=document.getElementById(this.__getDashboardSectionId()),f=document.createElement("div");f.style.textAlign="center";var g=document.createElement("a");g.style.textDecoration="underline",g.id=this.__getDashboardSectionSwapLinkId(),g.innerHTML=this.currentScanType==a.SCAN_TYPE_CAMERA?c:d,g.href="#scan-using-file",g.addEventListener("click",function(){return b.sectionSwapAllowed?void(b.__setStatus("IDLE"),b.__resetHeaderMessage(),b.__getFileScanInput().value="",b.sectionSwapAllowed=!1,b.currentScanType==a.SCAN_TYPE_CAMERA?(b.__clearScanRegion(),b.__getFileScanInput().disabled=!1,b.__getCameraScanRegion().style.display="none",b.__getFileScanRegion().style.display="block",g.innerHTML=d,b.currentScanType=a.SCAN_TYPE_FILE,b.__insertFileScanImageToScanRegion()):(b.__clearScanRegion(),b.__getFileScanInput().disabled=!0,b.__getCameraScanRegion().style.display="block",b.__getFileScanRegion().style.display="none",g.innerHTML=c,b.currentScanType=a.SCAN_TYPE_CAMERA,b.__insertCameraScanImageToScanRegion()),b.sectionSwapAllowed=!0):void(b.verbose&&console.error("Section swap called when not allowed"))}),f.appendChild(g),e.appendChild(f)}},{key:"__setStatus",value:function(b,c){c||(c=a.STATUS_DEFAULT);var d=document.getElementById(this.__getStatusSpanId());switch(d.innerHTML=b,c){case a.STATUS_SUCCESS:d.style.background="#6aaf5042",d.style.color="#477735";break;case a.STATUS_WARNING:d.style.background="#cb243124",d.style.color="#cb2431";break;case a.STATUS_DEFAULT:default:d.style.background="#eef",d.style.color="rgb(17, 17, 17)";}}},{key:"__resetHeaderMessage",value:function(){var a=document.getElementById(this.__getHeaderMessageContainerId());a.style.display="none"}},{key:"__setHeaderMessage",value:function(b,c){c||(c=a.STATUS_DEFAULT);var d=document.getElementById(this.__getHeaderMessageContainerId());switch(d.innerHTML=b,d.style.display="block",c){case a.STATUS_SUCCESS:d.style.background="#6aaf5042",d.style.color="#477735";break;case a.STATUS_WARNING:d.style.background="#cb243124",d.style.color="#cb2431";break;case a.STATUS_DEFAULT:default:d.style.background="#00000000",d.style.color="rgb(17, 17, 17)";}}},{key:"_showHideScanTypeSwapLink",value:function(a){!0!==a&&(a=!1),this.sectionSwapAllowed=a,this.__getDashboardSectionSwapLink().style.display=a?"inline-block":"none"}},{key:"__insertCameraScanImageToScanRegion",value:function(){var b=this,c=document.getElementById(this.__getScanRegionId());return this.cameraScanImage?(c.innerHTML="<br>",void c.appendChild(this.cameraScanImage)):void(this.cameraScanImage=new Image,this.cameraScanImage.onload=function(){c.innerHTML="<br>",c.appendChild(b.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity=.3,this.cameraScanImage.src=a.ASSET_CAMERA_SCAN)}},{key:"__insertFileScanImageToScanRegion",value:function(){var b=this,c=document.getElementById(this.__getScanRegionId());return this.fileScanImage?(c.innerHTML="<br>",void c.appendChild(this.fileScanImage)):void(this.fileScanImage=new Image,this.fileScanImage.onload=function(){c.innerHTML="<br>",c.appendChild(b.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity=.3,this.fileScanImage.src=a.ASSET_FILE_SCAN)}},{key:"__clearScanRegion",value:function(){var a=document.getElementById(this.__getScanRegionId());a.innerHTML=""}},{key:"__getDashboardSectionId",value:function(){return"".concat(this.elementId,"__dashboard_section")}},{key:"__getDashboardSectionCameraScanRegionId",value:function(){return"".concat(this.elementId,"__dashboard_section_csr")}},{key:"__getDashboardSectionFileScanRegionId",value:function(){return"".concat(this.elementId,"__dashboard_section_fsr")}},{key:"__getDashboardSectionSwapLinkId",value:function(){return"".concat(this.elementId,"__dashboard_section_swaplink")}},{key:"__getScanRegionId",value:function(){return"".concat(this.elementId,"__scan_region")}},{key:"__getDashboardId",value:function(){return"".concat(this.elementId,"__dashboard")}},{key:"__getFileScanInputId",value:function(){return"".concat(this.elementId,"__filescan_input")}},{key:"__getStatusSpanId",value:function(){return"".concat(this.elementId,"__status_span")}},{key:"__getHeaderMessageContainerId",value:function(){return"".concat(this.elementId,"__header_message")}},{key:"__getCameraSelectionId",value:function(){return"".concat(this.elementId,"__camera_selection")}},{key:"__getCameraScanRegion",value:function(){return document.getElementById(this.__getDashboardSectionCameraScanRegionId())}},{key:"__getFileScanRegion",value:function(){return document.getElementById(this.__getDashboardSectionFileScanRegionId())}},{key:"__getFileScanInput",value:function(){return document.getElementById(this.__getFileScanInputId())}},{key:"__getDashboardSectionSwapLink",value:function(){return document.getElementById(this.__getDashboardSectionSwapLinkId())}}]),a}();_defineProperty(Html5QrcodeScanner,"SCAN_TYPE_CAMERA","SCAN_TYPE_CAMERA"),_defineProperty(Html5QrcodeScanner,"SCAN_TYPE_FILE","SCAN_TYPE_FILE"),_defineProperty(Html5QrcodeScanner,"STATUS_SUCCESS","STATUS_SUCCESS"),_defineProperty(Html5QrcodeScanner,"STATUS_WARNING","STATUS_WARNING"),_defineProperty(Html5QrcodeScanner,"STATUS_DEFAULT","STATUS_DEFAULT"),_defineProperty(Html5QrcodeScanner,"ASSET_FILE_SCAN","https://raw.githubusercontent.com/mebjas/html5-qrcode/master/assets/file-scan.gif"),_defineProperty(Html5QrcodeScanner,"ASSET_CAMERA_SCAN","https://raw.githubusercontent.com/mebjas/html5-qrcode/master/assets/camera-scan.gif");